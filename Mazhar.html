<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بژمێری یەکەی بەکارهێنراوی ووزەی کارەبا</title>
    <style>


        body {
            font-family: Arial, sans-serif;
            background-color: darkblue;
            padding: 10px;
            color: white;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background: #fff;
            padding: 5px;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
            color: black;
        }
        h2 {
            text-align: center;
            margin-bottom: 8px;
            color: black;
        }
        .form-group {
            margin-bottom: 10px;
        }
 .form-group1 {
            margin-bottom: 10px;
        }
        .form-row {
            display: flex;
            justify-content: space-between;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
.form-group1 label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
    .form-group1 input {
            width: 50%;
            padding: 8px;
            box-sizing: border-box;
        }
.form-group1 {
            flex: 1;
            margin-left: 10px;
        }


        .form-group {
            flex: 1;
            margin-left: 10px;
        }
        .form-group:last-child {
            margin-left: 0;
        }
        .result {
            margin-top: 10px;
            background: #e4e4e4;
            padding: 8px;
            border-radius: 5px;
        }
        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color:#5e005f;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color:#9F2B68;
        }
        .error {
            color: red;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .checkbox-group {
            display: flex;
            margin-bottom: 15px;
        }
.checkbox-group1 {
            display: flex;
            margin-bottom: 15px;
        }
        .checkbox-group label {
          font-size: 11px;
         
        }
        .checkbox-group1 label {
          font-size: 14px;
         
        }
        .high-reading {
            color: red;
            font-weight: bold;
        }

        
        .consumed-units1 {
            color: red;
            font-weight: bold;
        }
        .total-cost {
            color: green;
        }
        .pol {
           color: MediumVioletRed;

            }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 5px;
        }
        th, td {
            padding: 4px;
            border: 1px solid #ccc;
            text-align: center;
         
        }
        th {
            background-color: lightgreen; /* Light green header */
            color: black; /* Black text for header */
        }

 .textfield-group {
            display: flex;
            justify-content: space-between; /* Space between text fields */
        }

        .textfield-group input {
            width: 60%; /* Adjust the width to ensure three fit in one row */
            padding: 5px;
            margin: 2px;
            box-sizing: border-box; /* Makes sure padding is included in width */
        }

        .textfield-group + .textfield-group {
            margin-top: 2px; /* Space between the two rows of text fields */
        }



h4.no-print {
    margin: 10px 0; /* Adjust the values as needed */
  }

       

 

        /* Print Styles */
@media print {

    body {
        color: black;
        background-color: white;
    }

    th {
        background-color: lightgreen !important;
        -webkit-print-color-adjust: exact; /* Ensures color is retained during print */
    }

    .container {
        box-shadow: none;
    }

  .high-reading {
        color: red; /* Retain colored texts */
        margin: 0;
    }
.consumed-units1 {
        color: red; /* Retain colored texts */
        margin: 10px;
    }





    th {
        background-color: lightgreen; /* Retain light green header in print */
        color: black; /* Black text for header in print */
    }

   

    .form-group,
    .form-group1,
    .checkbox-group,
    .checkbox-group1,
    .textfield-group,
    button {
        display: none; /* Hide form inputs and buttons when printing */
    }

    h2 {
        display: block; /* Ensure the heading is visible in print */
        color: black;
    }

    .no-print {
        display: none;
    }
}

    h3.total-cost, h3.pol {
        margin: 5px 0; /* Adjust the top and bottom margin */
    }


        h3 {
            margin-top: 8px;
            margin-bottom: 14px;
        }

    </style>
</head>
<body>

    <div class="container">
<h3 style="text-align: center; color: purple; font-weight: bold;">
    بژمێری یەکەی بەکارهێنراوی ووزەی کارەبا
</h3>
       

<div class="textfield-group">

        <input type="text" id="naw" placeholder="ناو">
  
<input type="number" id="zh_hazhmar" placeholder="ژمارەی هەژمار" maxlength="11" oninput="if(this.value.length > 11) this.value = this.value.slice(0, 11);" />
        

    </div>
    <div class="textfield-group">
        
<input type="number" id="zh_pewar" placeholder="ژمارەی پێوەر">
<input type="number" id="zh_hawbash" placeholder="ژمارەی هاوبەش">
</div>
    <div class="textfield-group">
        <input type="text" id="block" placeholder="بلۆک/ زنجیرە">
 <input type="text" id="address" placeholder="ناونیشان">       

<input type="number" id="pol" placeholder="پۆل">
        
    
    </div>

 <div class="form-row">
 <div class="form-group">

       <label for="previousReading" style="color: #E0115F; font-weight: bold;">خوێندنەوەی پێشوو :</label>
                <input type="number" id="previousReading" placeholder="خوێندنەوەی پێشوو بنوسە" required>
            </div>
            <div class="form-group">
                <label for="previousDate" style="color: #E0115F; font-weight: bold;">بەرواری پێشوو :</label>
                <input type="date" id="previousDate" required>
          
  </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="lastReading" style="color: #E0115F; font-weight: bold;">کۆتا خوێندنەوە :</label>
                <input type="number" id="lastReading" placeholder="کۆتا خوێندنەوە بنوسە" required>
            </div>

            <div class="form-group">
                <label for="lastDate" style="color: #E0115F; font-weight: bold;">کۆتا بەروار :</label>
        <input type="date" id="lastDate" required>
            </div>

           </div>
  <div class="form-row">
            <div class="form-group1">


                 <label for="hawkolka" style="color:DeepPink;font-weight:bold;">هاوکۆلکە</label>
                <input type="number" id="hawkolka" value="1">
            </div>



</div>


<div class="checkbox-group1">


       <input type="checkbox" id="zyan"/>
            <label for="zyan" style="color:DeepPink;font-weight:bold;">زیانی گۆڕەر</label>
</div>

        
            


        <div class="checkbox-group">

       <input type="checkbox" id="mallan" onclick="onlyOne(this)") />

            <label for="mallan">ماڵان</label>
       
            <input type="checkbox" id="dukan" onclick="onlyOne(this)") />

            <label for="dukan">بازرگانی</label>
       

    <input type="checkbox" id="kshtukaly" onclick="onlyOne(this)"/>
            <label for="kshtukaly">کشتوکاڵی</label>

<input type="checkbox" id="mery" onclick="onlyOne(this)"/>
            <label for="mery">میری</label>

<input type="checkbox" id="peshasazy" onclick="onlyOne(this)"/>
           
 <label for="peshasazy">پیشەسازی Kv 0.416</label>

<input type="checkbox" id="peshasazy_1" onclick="onlyOne(this)"/>
 
 <label for="peshasazy_1">پیشەسازی Kv 132,33,11</label>


 </div>

        <div id="error" class="error"></div>
        
        <button onclick="calculateCost()">ژماردن</button>
        <button onclick="printResults()">چاپ</button>

        <div class="result" id="result"></div>
    </div>


    <script>

function onlyOne(checkbox) {
  var checkboxes = document.querySelectorAll('input[type="checkbox"]');
 checkboxes.forEach((item) => {
    if (item !== checkbox) item.checked = false;
  });
}
       

      

  function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        function roundToNearest(value, roundTo) {
            return Math.round(value / roundTo) * roundTo;
        }

        function calculateCost() 
{

             const naw = document.getElementById('naw').value;

             const zh_hazhmar = document.getElementById('zh_hazhmar').value;    

             const zh_hawbash = document.getElementById('zh_hawbash').value;    
             const zh_pewar = document.getElementById('zh_pewar').value;    
             const pol = document.getElementById('pol').value;    
              
             const nawnishan = document.getElementById('address').value;
 
            const znjira = document.getElementById('block').value;


            const prevReading = parseFloat(document.getElementById('previousReading').value);
            const lastReading = parseFloat(document.getElementById('lastReading').value);
            const prevDate = new Date(document.getElementById('previousDate').value);
            const lastDate = new Date(document.getElementById('lastDate').value);     
            const hawkolka = parseFloat(document.getElementById('hawkolka').value);        
            const isMallan = document.getElementById('mallan').checked;
           
            const isDukan = document.getElementById('dukan').checked;
            const isKshtukaly = document.getElementById('kshtukaly').checked;
            const isMery = document.getElementById('mery').checked;
            const isPeshasazy = document.getElementById('peshasazy').checked;
            const isPeshasazy_1 = document.getElementById('peshasazy_1').checked;
            const isZyan = document.getElementById('zyan').checked;
            const errorDiv = document.getElementById('error');
            const resultDiv = document.getElementById('result');

            // Clear previous error messages
            errorDiv.innerHTML = '';
            resultDiv.innerHTML = '';

if (prevReading<0 || lastReading<0) {
                errorDiv.innerHTML = 'خوێندنەوەی پێشوو پاشان خوێندنەوەی ئێستا بنووسە یان هەڵەیەک هەیە.';
                return;
            }




 
 // Validation: Check if the last reading is less than the previous reading
            if (lastReading < prevReading && !(prevReading >= 70000 && prevReading <= 99999 && lastReading <= 40000 && lastReading >=1 || prevReading >= 970000 && prevReading <= 999999 && lastReading <= 40000 && lastReading >=1)) {
               errorDiv.innerHTML = 'خوێندنەوەی ئێستا نابێت کەمتر بێت لە خوێندنەوەی  پێشوو چونکە یەکەی بەکارهێنراو سالب دەبێت.';
              return;
           }

 if (prevDate > lastDate) {
                errorDiv.innerHTML = 'نابێت کۆتا بەروار کەمتر بێت لە بەرواری پێشوو.';
                return;
            }


  
  if (!Number.isInteger(Number(prevReading)) || !Number.isInteger(Number(lastReading))) 
{
 errorDiv.innerHTML = 'پێویستە ژمارەی تەواو بنوسیت.';
                return;

}



    

           
            // New condition for readings crossing 99999 & 999999
            let consumedUnits;
            if (prevReading >= 70000 && prevReading <= 99999 && lastReading <= 40000 && lastReading >= 1 && !(prevReading<1 || lastReading<1)) 

{
                consumedUnits = (lastReading + 99999 - prevReading) * hawkolka;
                resultDiv.innerHTML += "<p class='high-reading'>اکمال دەورە.</p>";
 

}
 
else if (prevReading >= 970000 && prevReading <= 999999 && lastReading <= 40000 && lastReading >= 1 && !(prevReading<1 || lastReading<1)) {
                consumedUnits = (lastReading + 999999 - prevReading) * hawkolka;
                resultDiv.innerHTML += "<p class='high-reading'>اکمال دەورە.</p>";
 


 }




else {
                consumedUnits = (lastReading - prevReading)*hawkolka;
            }
if(isZyan)   
{

consumedUnits += consumedUnits * 0.025;

}

            
            



            const days = (lastDate - prevDate) / (1000 * 3600 * 24); // convert milliseconds to days

            // Check for high consumption condition ((consumedUnits / days) * 30) >= 1800

if (days==0 && consumedUnits==0) {
                errorDiv.innerHTML = 'داخراو.';
                return;
            }
           
if (!days || days==0) {
                errorDiv.innerHTML = 'هەڵە لە هەڵبژاردنی بەروار هەیە.';
                return;
            }

if (prevReading<0 || lastReading<0)
{

 errorDiv.innerHTML = 'هەڵە هەیە لە داخڵ کردنی ژمارە.';
                return;

}
 



            let totalCost = 0;
            let resultString = `<p class="consumed-units1">یەکەی بەکارهێنراو :  ${formatNumber(consumedUnits)} یەکەیە لە ماوەی ${days} ڕۆژدا = ${(days/30.44).toFixed(3)} مانگ = ${(days/365.25).toFixed(3)} ساڵ</p>`;

let enteredValuesTable1 = `
    <div style="display: flex; flex-direction: row; flex-wrap: wrap; gap: 10px; width: 100%;">
        <div style="flex-basis: 45%;">
            ناو: ${naw}<br>
            ژ.هەژمار: ${zh_hazhmar}<br>
           ژ.پێوەر: ${zh_pewar}<br>
ژ.هاوبەش: ${zh_hawbash}<br>
        </div>
        <div style="flex-basis: 45%;">

            بلۆک: ${znjira}<br>
            ناونیشان: ${nawnishan}<br>
            پۆل: ${pol}<br>
        </div>
    </div>
`;

let enteredValuesTable = `
                <table>
                    <tr><th>خوێندنەوەی پێشوو</th><td>${formatNumber(prevReading)}</td></tr>
                    <tr><th>بەرواری پێشوو</th><td>${`${prevDate.getFullYear()}-${String(prevDate.getMonth() + 1).padStart(2, '0')}-${String(prevDate.getDate()).padStart(2, '0')}`}</td></tr>
                    <tr><th>کۆتا خوێندنەوە</th><td>${formatNumber(lastReading)}</td></tr>
                    <tr><th>کۆتا بەروار</th><td>${`${lastDate.getFullYear()}-${String(lastDate.getMonth() + 1).padStart(2, '0')}-${String(lastDate.getDate()).padStart(2, '0')}`}</td></tr>
      <tr><th>هاوکۆلکە</th><td>${formatNumber(hawkolka)}</td></tr>
                </table>
            `;


            

if(isZyan)
{

resultDiv.innerHTML += `<h4 class="pol" style="margin: 2px 0;">زیانی گۆڕەر هەیە.</h4>`;
}

            let breakdownTable = `<table><tr><th>پۆلێنی نرخەکان</th><th>یەکەی بەکار هاتوو</th><th>نرخ</th></tr>`;



            // If Dukan is checked, multiply consumed units by 156
        
             if (isDukan) {

 const dukanCost=consumedUnits * 156;
                totalCost += dukanCost;
                breakdownTable += `<tr><td>156</td><td>${formatNumber(consumedUnits)}</td><td>${formatNumber(Math.floor(dukanCost))}</td></tr>`;
   const originalTotalCost = Math.floor(totalCost);
            const roundedTotalCost = roundToNearest(originalTotalCost, 250);
            const difference = originalTotalCost - roundedTotalCost;

                resultDiv.innerHTML += enteredValuesTable;
                resultDiv.innerHTML += resultString;
                breakdownTable += `</table>`;
                resultDiv.innerHTML += breakdownTable;
resultDiv.innerHTML += `<h3 class="pol">بازرگانی</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی نرخی بنەڕەتی: ${formatNumber(Math.floor(dukanCost))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی پوختەی نرخ: ${formatNumber(roundToNearest(Math.floor(dukanCost), 250))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">وردە: ${formatNumber(difference)} دینار.</h3>`;
                return;
            }



            if (isKshtukaly) {
                const kshtukalCost = consumedUnits * 36;
                totalCost += kshtukalCost;
                breakdownTable += `<tr><td>36</td><td>${formatNumber(consumedUnits)}</td><td>${formatNumber(Math.floor(kshtukalCost))}</td></tr>`;
   const originalTotalCost = Math.floor(totalCost);
            const roundedTotalCost = roundToNearest(originalTotalCost, 250);
            const difference = originalTotalCost - roundedTotalCost;

                resultDiv.innerHTML += enteredValuesTable;
                resultDiv.innerHTML += resultString;
                breakdownTable += `</table>`;
                resultDiv.innerHTML += breakdownTable;
resultDiv.innerHTML += `<h3 class="pol">کشتوکاڵی</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی نرخی بنەڕەتی: ${formatNumber(Math.floor(kshtukalCost))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی پوختەی نرخ: ${formatNumber(roundToNearest(Math.floor(kshtukalCost), 250))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">وردە: ${formatNumber(difference)} دینار.</h3>`;
                return;
            }

 if (isMery) {
                const meryCost = consumedUnits * 80;
                totalCost += meryCost;
                breakdownTable += `<tr><td>80</td><td>${formatNumber(consumedUnits)}</td><td>${formatNumber(Math.floor(meryCost))}</td></tr>`;
   const originalTotalCost = Math.floor(totalCost);
            const roundedTotalCost = roundToNearest(originalTotalCost, 250);
            const difference = originalTotalCost - roundedTotalCost;

                resultDiv.innerHTML += enteredValuesTable;
                resultDiv.innerHTML += resultString;
                breakdownTable += `</table>`;
                resultDiv.innerHTML += breakdownTable;
resultDiv.innerHTML += `<h3 class="pol">میری</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی نرخی بنەڕەتی: ${formatNumber(Math.floor(meryCost))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی پوختەی نرخ: ${formatNumber(roundToNearest(Math.floor(meryCost), 250))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">وردە: ${formatNumber(difference)} دینار.</h3>`;
                return;
            }
 if (isPeshasazy) {
                const peshasazyCost = consumedUnits * 144;
                totalCost += peshasazyCost;
                breakdownTable += `<tr><td>144</td><td>${formatNumber(consumedUnits)}</td><td>${formatNumber(Math.floor(peshasazyCost))}</td></tr>`;
   const originalTotalCost = Math.floor(totalCost);
            const roundedTotalCost = roundToNearest(originalTotalCost, 250);
            const difference = originalTotalCost - roundedTotalCost;

                resultDiv.innerHTML += enteredValuesTable;
                resultDiv.innerHTML += resultString;
                breakdownTable += `</table>`;
                resultDiv.innerHTML += breakdownTable;
resultDiv.innerHTML += `<h3 class="pol">پیشەسازی (Kv 0.416)</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی نرخی بنەڕەتی: ${formatNumber(Math.floor(peshasazyCost))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی پوختەی نرخ: ${formatNumber(roundToNearest(Math.floor(peshasazyCost), 250))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">وردە: ${formatNumber(difference)} دینار.</h3>`;
                return;
            }





if (isPeshasazy_1) {


                const peshasazyCost_1 = consumedUnits * 120;
                totalCost += peshasazyCost_1;
                breakdownTable += `<tr><td>120</td><td>${formatNumber(consumedUnits)}</td><td>${formatNumber(Math.floor(peshasazyCost_1))}</td></tr>`;
   const originalTotalCost = Math.floor(totalCost);
            const roundedTotalCost = roundToNearest(originalTotalCost, 250);
            const difference = originalTotalCost - roundedTotalCost;

                resultDiv.innerHTML += enteredValuesTable;
                resultDiv.innerHTML += resultString;
                breakdownTable += `</table>`;
                resultDiv.innerHTML += breakdownTable;

resultDiv.innerHTML += `<h3 class="pol">پیشەسازی (Kv 132,33,11)</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی نرخی بنەڕەتی: ${formatNumber(Math.floor(peshasazyCost_1))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">کۆی گشتی پوختەی نرخ: ${formatNumber(roundToNearest(Math.floor(peshasazyCost_1), 250))} دینار.</h3>`;
                resultDiv.innerHTML += `<h3 class="total-cost">وردە: ${formatNumber(difference)} دینار.</h3>`;
                return;
            }











if(isMallan)
{
 if ((consumedUnits / days) * 30 >= 1800) {
                resultDiv.innerHTML += "<p class='high-reading'>ئەم خوێندنەوەیە بەرزە چونکە زیاتر لە 1800 یەکە بەکار هێنراوە لە ماوەی مانگێک یان کەمتر لە مانگێکدا.</p>";
            }
            // Constants for different units
            const unitRates = [18, 24, 42, 72, 90, 180, 240];
            const periodUnits = [15, 15, 20, 20, 30, 66.66666667, consumedUnits]; // Unit consumption limits for each rate
            let remainingUnits = consumedUnits;

            // Calculate cost based on each unit rate
            for (let i = 0; i < unitRates.length; i++) {
                let maxUnits = Math.min(days * periodUnits[i], remainingUnits);
                let cost = maxUnits * unitRates[i];
                totalCost += cost;
                remainingUnits -= maxUnits;
                breakdownTable += `<tr><td>${unitRates[i]}</td><td>${formatNumber(Math.floor(maxUnits))}</td><td>${formatNumber(Math.floor(cost))}</td></tr>`;

                if (remainingUnits <= 0) break;
            }

            breakdownTable += `</table>`;
             resultDiv.innerHTML += enteredValuesTable1;
            resultDiv.innerHTML += enteredValuesTable;
            resultDiv.innerHTML += resultString;
            resultDiv.innerHTML += breakdownTable;

            const originalTotalCost = Math.floor(totalCost);
            const roundedTotalCost = roundToNearest(originalTotalCost, 250);
            const difference = originalTotalCost - roundedTotalCost;

            // Display the original total cost, rounded total cost, and the difference

           resultDiv.innerHTML += `<h3 class="pol" style="margin: 5px 0;">ماڵ</h3>`;
resultDiv.innerHTML += `<h3 class="total-cost" style="margin: 5px 0;">کۆی گشتی نرخی بنەڕەتی: ${formatNumber(originalTotalCost)} دینار.</h3>`;
resultDiv.innerHTML += `<h3 class="total-cost" style="margin: 5px 0;">کۆی گشتی پوختەی نرخ: ${formatNumber(roundedTotalCost)} دینار.</h3>`;
resultDiv.innerHTML += `<h3 class="total-cost" style="margin: 5px 0;">وردە: ${formatNumber(difference)} دینار.</h3>`;
    return;
}
}

       // Print the result and table, excluding form elements
        function printResults() {
            const originalContents = document.body.innerHTML;
            const printContents = document.querySelector('.result').innerHTML;
            const titleContents = document.querySelector('h3').outerHTML;
            const containerStyles = document.querySelector('.container').getAttribute('style');
            
            document.body.innerHTML = `<div class="container" style="${containerStyles}">${titleContents}${printContents}</div>`;
            window.print();
            document.body.innerHTML = originalContents;
        }
    </script>
<h4 align="center"class="no-print">دروستکراوە لە لایەن : مەزهەر عبدالقادر محمد</h4>
<h4 align="center"class="no-print">بەڕێوەبەرایەتی دابەشکردنی کارەبای سیدصادق</h4>
</body>
</html>